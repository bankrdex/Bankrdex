"use strict";(()=>{var e={};e.id=974,e.ids=[974],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},926:(e,r,n)=>{n.r(r),n.d(r,{config:()=>d,default:()=>u,routeModule:()=>p});var s={};n.r(s),n.d(s,{default:()=>handler});var t=n(802),a=n(44),o=n(249);let i=null,c=!1;function getBankrClient(){if(c)return i;c=!0;let e=process.env.BANKR_PRIVATE_KEY;if(!e)return console.warn("⚠️ BANKR_PRIVATE_KEY not set; Bankr SDK will use fallback behavior"),null;try{let{BankrClient:r}=n(Object(function(){var e=Error("Cannot find module '@bankr/sdk'");throw e.code="MODULE_NOT_FOUND",e}()));return i=new r({privateKey:e,baseChainId:process.env.BANKR_BASE_CHAIN_ID||"8453",rpcUrl:"https://mainnet.base.org"})}catch(e){return console.warn("⚠️ Failed to initialize Bankr SDK:",e?.message),null}}async function executeBankrPrompt(e,r){if(!e||0===e.trim().length)throw Error("Prompt cannot be empty");try{let n=getBankrClient();if(!n)return console.log("\uD83D\uDCCA [Bankr] Using fallback (SDK not initialized):",e),{success:!0,message:`[Fallback] Bankr AI would process: "${e}"`,transactionHash:"0x"+Math.random().toString(16).slice(2),raw:{fallback:!0,prompt:e}};let s=r?.chainId||process.env.BANKR_BASE_CHAIN_ID||"8453",t=await n.promptAndWait(e,{chainId:s,paymentToken:"USDC",paymentAmount:"0.10"}),a=t?.transactionHash||t?.txHash||void 0;return{success:!0,message:t?.message||JSON.stringify(t),transactionHash:a,raw:t}}catch(e){throw Error(e?.message||String(e))}}let l={};async function handler(e,r){if("POST"!==e.method)return r.status(405).json({success:!1,response:"Method not allowed",error:"Only POST supported"});try{let{prompt:n,walletAddress:s}=e.body;if(!n||!s)return r.status(400).json({success:!1,response:"Invalid request",error:"prompt and walletAddress are required"});if(l[s]||(l[s]=1e3),l[s]<.1)return r.status(402).json({success:!1,response:"Insufficient balance",error:"Need $0.10 USDC"});l[s]-=.1;let t=await executeBankrPrompt(n,{chainId:process.env.BANKR_BASE_CHAIN_ID||"8453"});return r.status(200).json({success:t.success,response:t.message,transactionExecuted:!!t.transactionHash,transactionHash:t.transactionHash,newBalance:l[s].toFixed(2)})}catch(e){return console.error("Bankr API error:",e?.message||e),r.status(500).json({success:!1,response:"Internal server error",error:e?.message||String(e)})}}let u=(0,o.l)(s,"default"),d=(0,o.l)(s,"config"),p=new t.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/bankr",pathname:"/api/bankr",bundlePath:"",filename:""},userland:s})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),n=r.X(0,[222],()=>__webpack_exec__(926));module.exports=n})();